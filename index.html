<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sLapH-contractions: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "simplewick.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sLapH-contractions
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sLapH-contractions Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is the new version of the contraction code.</p>
<p><a href="https://github.com/maowerner/sLapH-contractions">GitHub Page</a></p>
<p><a href="https://maowerner.github.io/sLapH-contractions">Doxygen Documentation</a></p>
<p><a href="https://travis-ci.org/maowerner/sLapH-contractions"></a></p>
<p>A Wick contraction in this context means the analytic result obtained when "integrating out" fermionic degrees of freedom from the path integral in lattice QCD. Therefor it builds the bridge between the results of the numerical integration and the physical observables as described in section sec:intro by computing the euclidean correlator.</p>
<p>In the sLapH framework space is approximated by the span of the eigenvectors of a Laplace operator, below referred to as eigenvector space. Introducing random vectors and dilution in time, eigenvector and Dirac space yields a stochastical estimate for the propagator. The correlation function can be expressed as a trace of products of propagators, eigenvectors and field operators ( \(\Gamma\)).</p>
<p>In the framework of the LapHs-method, the quark lines could be expressed by the \( V_s \) whose dimension was the number of LapH eigenvectors. Thus for the LapHs-method it is possible to only apply the random vectors in the LapH-subspce spanned by spin, time and LapH eigenvector number. To distinguish these random vectors from the usual ones, the are denoted by \( \rho \). For the Quark lines this results in </p><p class="formulaDsp">
\begin{align} \mathcal{Q} = \sum_b { E \left( V_s V_s^\dagger \Omega^{-1} V_s P^{(b)} \rho ( V_s P^{(b)} \rho)^\dagger \right)}. \end{align}
</p>
<p>To illustrate these rather abstract concepts, the example of a single charged pion shall be discussed. Its quantum numbers are \( J^P = 0^- \), a pseudoscaler particle. The operator with the largest overlap to the charged pion is </p><p class="formulaDsp">
\begin{align} O_{\pi^+}(n) = u(n) \gamma_5 \bar{d}(n). \end{align}
</p>
<p> The Operators in the euclidean correlator are then chosen to be a pion creation operator \( O_{\pi^+}^\dagger(n) \) and a pion annihilation operator \( O_{\pi^+}(m) \) at two different lattice points $m$, $n$. Inserting this into the path integral eq. {eq:correlatorlqcd} the fermionic part is a Grassmann integration that can be carried out analytically by performing a Wick-contraction. It will be denoted as the fermionic expectation value \( \langle \rangle_F \).</p>
<p class="formulaDsp">
\begin{align} \bcontraction[1ex]{\langle O_{\pi^+}(\vec{m}, m_4) O_{\pi^+}^\dagger(\vec{n}, n_4) \rangle_F = \quad ~ \ - \langle}{\bar{d}}{(\vec{m}, m_4)\gamma_5 u(\vec{m}, m_4) \bar{u}(\vec{n}, n_4) \gamma_5}{d} \bcontraction[2ex]{\langle O_{\pi^+}(\vec{m}, m_4) \O_{\pi^+}^\dagger(\vec{n}, n_4) \rangle_F =\quad ~ \ - \langle \bar{d}(\vec{m}, m_4) \gamma_5}{u}{(\vec{m}, m_4)}{\bar{u}} \langle O_{\pi^+}(\vec{m}, m_4) O_{\pi^+}^\dagger(\vec{n}, n_4) \rangle_F =&amp;&amp; - \langle \bar{d}(\vec{m}, m_4) \gamma_5 u(\vec{m}, m_4) \bar{u}(\vec{n}, n_4) \gamma_5 d(\vec{n}, n_4) \rangle_F \nonumber \\ =&amp;&amp; tr(\gamma_5 D_u^{-1}(\vec{m}, m_4 | \vec{n}, n_4) \gamma_5 D_d^{-1}(\vec{n}, n_4 | \vec{m}, m_4)^\dagger ). \end{align}
</p>
<p>With eq. eq:quarkline as stochastical estimate for the propagator, the correlator can be expressed in terms of the quantities introduced in section sec:laphs The cyclicity of the trace and the \( \gamma_5 \)-trick</p>
<p class="formulaDsp">
\begin{align} D_d^{-1}(m | n) &amp;=&amp; \gamma_5 D_u^{-1}(n | m) \gamma_5 \end{align}
</p>
<p>were used. More details are given in bulava2009}</p>
<p class="formulaDsp">
\begin{align} C_\pi(m_4, n_4) &amp;=&amp; tr \left( \gamma_5 \left(\sum_{\vec{m}, \vec{n}&#39;} V_s(\vec{m}, m_4)^\dagger \Omega_u^{-1}(\vec{m}, \vec{n}; m_4, n_4) \left(V_s(\vec{n}, n_4) P^{(b)} \rho \right) \right) \right. \nonumber \\ &amp;&amp; \left( \sum_{\vec{y}} \left( V_s(\vec{y}, m_4) P^{(b)} \rho \right)^\dagger \left( V_s(\vec{y}, m_4) P^{(b)} \rho \right) \right) \gamma_5 \nonumber \nonumber \\ &amp;&amp; \gamma_5 \left(\sum_{\vec{m}, \vec{n}} V_s(\vec{n}, m_4)^\dagger \Omega_u^{-1}(\vec{n}, \vec{m}; m_4, n_4) \left( V_s(\vec{m}, n_4) P^{(b)} \rho \right) \right)^\dagger \\ &amp;&amp; \left. \left( \sum_{\vec{y}} V_s(\vec{y}, n_4)^\dagger V_s(\vec{y}, n_4) \right) \gamma_5 \right) \nonumber . \end{align}
</p>
<p>This is the same expression one would also obtain from eq. (eq:correlatorquarklines). The correlator has now been calculated for every time combination $m_4, n_4$. The values with the same time difference \( (m_4 - n_4 + T) \mod T \) were added up to the so-called correlation function or correlator</p>
<p class="formulaDsp">
\begin{align} C_\pi(t) &amp;=&amp; \sum_{\stackrel{m_4, n_4}{t = (m_4 - n_4+T) \mod T}} C(m_4, n_4). \end{align}
</p>
<p>The resulting correlator consists of \( T \) data points and due to periodic boundary conditions on the lattice it has to be symmetric in \( t \).</p>
<p>To obtain multiple scattering phases and to obtain \( a_\ell \) and \( r_\text{eff} \) from a fit to the effective range expansion, the computation of \( \pi\pi \) scattering can be performed multiple times with different momenta. As a first test before simulating two pions with momenta, a single pion was given momentum and the results were checked by comparing them to the theoretical expectation given by the dispersion relation.</p>
<p>Momenta on the lattice are introduced by a Fourier transformation to momentum space. The correlators are given in cite{bulava2009} as for \( p^2 = 0 \) before. Including the momenta is a generalzation of eq. (eq:laphsC2nomom). defining formula is eq. (eq:correlatorquarklines):</p>
<p class="formulaDsp">
\begin{align} C_\pi(\vec{p}; m_4, n_4) &amp;=&amp; tr \left( \gamma_5 \left(\sum_{\vec{m}, \vec{n}&#39;} V_s(\vec{m}, m_4)^\dagger \Omega_u^{-1}(\vec{m}, \vec{n}; m_4, n_4) \left(V_s(\vec{n}, n_4) P^{(b)} \rho \right) \right) \right. \nonumber \\ &amp;&amp; \left( \sum_{\vec{y}} \left( V_s(\vec{y}, m_4) P^{(b)} \rho \right)^\dagger e^{-i \vec{p} \vec{y}} \left( V_s(\vec{y}, m_4) P^{(b)} \rho \right) \right) \gamma_5 \nonumber \nonumber \\ &amp;&amp; \gamma_5 \left(\sum_{\vec{m}, \vec{n}} V_s(\vec{n}, m_4)^\dagger \Omega_u^{-1}(\vec{n}, \vec{m}; m_4, n_4) \left( V_s(\vec{m}, n_4) P^{(b)} \rho \right) \right)^\dagger \\ &amp;&amp; \left. \left( \sum_{\vec{y}} V_s(\vec{y}, n_4)^\dagger e^{i \vec{p} \vec{y}} V_s(\vec{y}, n_4) \right) \gamma_5 \right) \nonumber . . \end{align}
</p>
<p>Indeed, in the limit case \( \vec{p} = 0 \) eq. (eq:laphsC2) assumes the form given in eq. (eq:laphsC2nomom). At this point it is important to note, that the \( \gamma_5 \)-trick does not change the sequential arrangement of the last two terms. An intuitive idea to save computational effort is multipying the first two brackets to obtain a \( u \)-quark propagator and daggering the resulting expression to obtain a \( d \)-quark propagator. For general momenta this is something different than the expression derived in eq (eq:laphsC2). The reason for this is, that the cyclic property of the trace has been used. The first two factors together are not to be mistaken with the propagator.</p>
<p>For \( \vec{p} = \vec{0} \) the sums over \( \vec{y} \) and \( \vec{y_0} \) assume the unit matrix as values and do not contibute.</p>
<p>The momentum on th lattice is quantized: \( \vec{p} = \frac{2 \pi}{L} \vec{n} \). \( \vec{n} \in \mathbb{Z}^3 \) denotes the a three-vector in terms of lattice units. Via \( \vec{n} \), direction and absolute value of the desired momentum can be chosen.</p>
<p>The stochastic estimates can be brought into a form which allows saving them to hard disk: The perambulator. This allows to reuse inverted propagators to "build" multiple correlation functions. This code calculates correlation functions in exactly this manner. It featurus</p>
<ul>
<li>IO functions for perambulators, random vectors, eigenvectors</li>
<li>An Infile to specify exactly the physical process in question<ul>
<li>Different quark flavors</li>
<li>Flexible Dilution schemes</li>
<li>Every linearly independent Dirac structure</li>
<li>Different momenta</li>
</ul>
</li>
<li>13 different diagrams for one- and two-meson operators pre-implemented</li>
</ul>
<p>As a starting point the main function is in <a class="el" href="contract_8cpp.html">contract.cpp</a></p>
<p>The issue of reusing certain parts for multiple diagrams achieved by calculating and saving quarklines. These hold particular combinations of perambulators and operators that appear in multiple diagrams.</p>
<p>In the work group codes existed codes to calculate the perambulators and eigensystems as introduced in ch. sec:laphs already before the beginning of this master thesis.</p>
<p>For the sake of notation, the arguments of functions will be stylized by parentheses and pointers to data structures are notated with attached square brackets.</p>
<p>The perambulator </p><p class="formulaDsp">
\begin{align} \mathbf{P} = V_s^\dagger \Omega^{-1} V_s P^{(b)} \rho \end{align}
</p>
<p> and the term </p><p class="formulaDsp">
\begin{align} \mathbf{B} &amp;=&amp; V_s^\dagger \exp{(i \vec{p} \vec{x})} V_s \end{align}
</p>
<p> appear repeatedly in the euclidean correlator eq. (eq:laphsC2nomom), (eq:laphsC2).</p>
<p>The perambulator can be used as it was read in. The term \( \mathbf{B} \) is saved into OperatorForMesons In the infile only the squared absolute value of the momentum is specified. The routine</p>
<p>The desired momenta and displacements are specified in the function call. If both are trivial \( \mathbf{B} = \mathbb{1} \) and it will be explicitly set to unity.</p>
<p>For full dilution of the dirac-index \( \mathbf{B} \) becomes blockdiagonal in dirac space. Writing the euclidean correlator in matrix-vector notation the product \( \mathbf{P} \cdot \mathbf{B} \) occurs. At this point the blockdiagonal structure can be exploited. Rather than a multiplication in which twelve of the sixteen blocks of \( \mathbf{B} \) are zero, it suffices to perform matrix multiplications for the four nonzero blocks.</p>
<p>The code I implemented exploits this feature to save the effort of the mulitplication \( D^{-1} \cdot \Gamma \). To illustrate the idea, I want to perform an example calculation.</p>
<p>Let w.l.o.g </p><p class="formulaDsp">
\begin{align} \mathbf{P} \cdot \mathbf{B} &amp;=&amp; \begin{pmatrix} 0 &amp; 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 &amp; 7 \\ 8 &amp; 9 &amp; 10 &amp; 11 \\ 12 &amp; 13 &amp; 14 &amp; 15 \end{pmatrix} \cdot \begin{pmatrix} A &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; B &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; C &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; D \end{pmatrix} \\ &amp;=&amp; \begin{pmatrix} 0A &amp; 1B &amp; 2C &amp; 3D \\ 4A &amp; 5B &amp; 6C &amp; 7D \\ 8A &amp; 9B &amp; 10C &amp; 11D \\ 12A &amp; 13B &amp; 14C &amp; 15D \end{pmatrix} \end{align}
</p>
<p>Here, \( \{0, \dots, 15\} \) denote blocks of size number_of_eigen_vec \( \cdot \) number_of_dilution_E and \( \{A, \dots, D\} \) blocks of size number_of_dilution_E \( \cdot \) number_of_eigen_vec. Performing \( D^{-1} \cdot \Gamma \) culminates in reordering columns of eqn. (eq:ptimesb) and multiplying with scalars. For example: </p><p class="formulaDsp">
\begin{align} \mathbf{P} \cdot \mathbf{B} \cdot \gamma_5 &amp;=&amp; \begin{pmatrix} 0A &amp; 1B &amp; -2C &amp; -3D \\ 4A &amp; 5B &amp; -6C &amp; -7D \\ 8A &amp; 9B &amp; -10C &amp; -11D \\ 12A &amp; 13B &amp; -14C &amp; -15D \end{pmatrix} \end{align}
</p>
<p>The contraction code supports positve and negative OS quarks. The \( u \)-quark propagator is given by</p>
<p class="formulaDsp">
\begin{align} D_u^{-1} &amp;=&amp; V_s V_s^\dagger \Omega_u^{-1} V_s V_s^\dagger P^{(b)} \rho (P^{(b)} \rho)^\dagger \\ &amp;=&amp; V_s \mathbf{P} (P^{(b)} \rho)^\dagger \end{align}
</p>
<p>Due to the \( \gamma_5 \)-trick the \( d \)-quark propagator can be obtained by </p><p class="formulaDsp">
\begin{align} D_d^{-1} &amp;=&amp; \gamma_5 (D_u^{-1})\dagger V_s^\dagger \gamma_5 \\ &amp;=&amp; \gamma_5 V_s (P^{(b)} \rho) \mathbf{P}^\dagger V_s^\dagger \gamma_5 \end{align}
</p>
<p> without the need to perform additional inversions for the Dirac matrix.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000037">Todo:</a></b></dt><dd>generalalize that for s and c quarks</dd></dl>
<p>For general momenta \( \mathbf{P} \) and \( \mathbf{B} \) do not commute. The multiplications required are performed in</p>
<p>The multiplication with the \( \Gamma \)-structure is performed seperately to reuse results as often as possible.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000038">Todo:</a></b></dt><dd>link to OperatorsForMesons here. Due to the blockdiagonal form of \( \mathbf{B} \) multiplication with a gamma-matrix is equivalent to reordering columns in dirac-space. Details on this reordering as well as an example are presented in appendix sec:gamma. The u-quark term is additionaly multiplied with \( P^{(b)} \rho \). The reason is, that in the end the trace of the whole product has to be taken for which only the diagonal elements need to be calculated. For general gamma structure the random vectors complicate that slightly. Rather than \( 4 N_t N_{\nu} \times 4 N_{\nu} \) the dimension of the matrices becomes \( 4 N_t N_{\nu} \times 4 N_{\nu}^{dil} \) Thus, the trace can be taken with a factor \( \frac{N_{\nu}}{N_{\nu}^{dil}} \) less floating point operations at the cost of an additional factor of </dd></dl>
<p>The baseline of the program flow is</p><ol type="1">
<li>Read infile</li>
<li><p class="startli">Determine the data needed to calculate the specified diagrams: The class <a class="el" href="struct_global_data.html">GlobalData</a> processes them to vectors of certain structs for Quarklines, Correlators and Operators.</p>
<p class="startli">Internally all physical loops are replaced with auto-loops over these structs. This allows to decouple the computation from the physical context and keep the code very clean where the indices are very complicated.</p>
</li>
<li>Read all necessary data. The perambulators and the random vectors are saved as attributes of LapH::Perambulator and LapH::RandomVector.</li>
<li>Build parts that are reusable. The operators are constructed in LapH::OperatorsForMesons. This is the only step where the eigenvectors are needed, thus they are read on the fly and discarded afterwards. The quarklines are constructed in LapH::Quarklines. <dl class="section note"><dt>Note</dt><dd>The operators referred to above live solely in time and eigenvector space. In order to save memory if multiple Dirac structures are to be calculated at once it has been factored out and is performed when building a quarkline or a correlator. They are in particular not identical to the quantum field operators</dd></dl>
</li>
<li>Construct the correlators. This happens in LapH::Correlators. The class has a private member function corresponding to and building the diagrams admissible in the infiles. </li>
</ol>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
